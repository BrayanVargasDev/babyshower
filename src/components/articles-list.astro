---
import type { Articulo } from '../interfaces';
import { supabase } from '../libs/supabase';

const { data, error } = await supabase
  .from('articulos')
  .select('*')
  .neq('totalDisponible', 0);

if (error) {
  console.error('Error fetching articles:', error);
}
---

<!-- Modal -->
<div
  id='giftListModal'
  class='fixed inset-0 z-50 hidden items-center justify-center bg-black/50 transition-all duration-300 ease-in-out'
>
  <div
    class='mx-4 max-h-[90vh] w-full max-w-4xl overflow-hidden rounded-xl bg-white shadow-xl'
  >
    <div class='flex items-center justify-between border-b p-6'>
      <h2
        class='text-primary font-title text-[clamp(1rem,3vw,2.25rem)] drop-shadow-md text-shadow-[0_0_2px_#000]'
      >
        Lista de Regalos para Helena
      </h2>
      <button
        id='closeGiftListModal'
        class='cursor-pointer text-2xl text-gray-500 hover:text-gray-700'
        >&times;</button
      >
    </div>
    <div
      class='max-h-[calc(90vh-140px)] overflow-y-auto p-6'
      style='scrollbar-width: thin;'
    >
      <ul class='list-disc space-y-4 pl-6'>
        {
          data?.map(item => (
            <li class='font-body text-lg text-gray-800'>
              {item.nombre} - {item.totalDisponible}
            </li>
          ))
        }
      </ul>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const openModal = document.getElementById('openGiftListModal');
      const closeModal = document.getElementById('closeGiftListModal');
      const modal = document.getElementById('giftListModal');

      openModal?.addEventListener('click', () => {
        modal?.classList.remove('hidden');
        modal?.classList.add('flex');
      });

      closeModal?.addEventListener('click', () => {
        modal?.classList.add('hidden');
        modal?.classList.remove('flex');
      });

      modal?.addEventListener('click', e => {
        if (e.target === modal) {
          modal.classList.add('hidden');
          modal.classList.remove('flex');
        }
      });
    });
  </script>
</div>
